(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{PTPi:function(e,t,o){"use strict";o.r(t);var r=o("DUip"),n=o("Valr"),i=o("QJY3"),a=o("lJaB"),s=o("PLN7"),c=o("6uu6"),l=o("efrx"),u=o("PSD3"),b=function(){function e(){}return e.prototype.standardErrorPopup=function(e,t,o){u.fire({icon:e,title:t,text:o})},e.prototype.registrationErrorPopup=function(e,t){u.fire({icon:"error",title:"Error",text:e.error.Message,footer:"You can find out more&nbsp;<a target='_blank' href='https://help.instagram.com/1094643983940381'><b>Here</b></a>",onClose:t})},e}(),p=o("TYT/"),d=o("hMSI"),h=o("PSD3"),g=function(){function e(e,t,o,r,n,i){this.auth=e,this.router=t,this.a=o,this.api=r,this.wizardData=n,this.cookieService=i,this.loggedInModel={loggedIn:!1,name:""},this.permissions=null,this.initPermissions(),this.a.setComponent(this.router)}return e.prototype.getLoginStatus=function(){var e=this;this.api.openOverlay(),this.auth.auth.getRedirectResult().then((function(t){e.api.closeOverlay(),t.hasOwnProperty("user")&&null!=t.user&&(console.log(t),e.validateUser(t))}),(function(e){h.fire({icon:"error",title:"Error occurred",text:"Seems like there may have been a network error. Please try again :)"})}))},e.prototype.ngOnInit=function(){},e.prototype.ngOnDestroy=function(){},e.prototype.login=function(){console.log(this.permissions),this.auth.login(this.permissions).then((function(e){}))},e.prototype.validateUser=function(e){var t=this;this.api.openOverlay(),this.api.determineUserRegistration(e).subscribe((function(e){if(t.api.closeOverlay(),!1!==e.hasPermissions)if(!0===e.isNew){if(0===e.data.length)return;t.wizardData.data=[],e.data.forEach((function(e){return t.wizardData.data.push({name:e.name,id:e.id})})),t.wizardData.populateButtons(),t.wizardData.firebaseUid=e.firebaseUserId,t.router.navigate(["register"])}else!1===e.isNew&&!0===e.hasAuth&&(null==e.token&&null==e.token&&""==e.token||(console.log(e),t.cookieService.set("TEMPKEY",e.token,t.getExpireDate(24)),t.router.navigate([""])));else h.fire({icon:"error",title:"Incorrect Permissions",text:"You will need to grant us all requested permissions in order to continue!"})}),(function(e){t.handleError(e)}))},e.prototype.handleError=function(e){var t=this;this.logout();var o=new b;e.hasOwnProperty("error")?o.registrationErrorPopup(e,(function(){t.regCallback()})):o.standardErrorPopup("error","Error","An unknown error has occurred. Please login and try again!")},e.prototype.regCallback=function(){h.fire({icon:"question",title:"Support",text:"If believe that the error is on our end or even if you're not sure, we urge you to contact us on: support@mail.modlium.com - We will prioritize your request.",onClose:function(){location.reload()}})},e.prototype.logout=function(){this.auth.logout()},e.prototype.getExpireDate=function(e){var t=new Date(Date.now());return t.setDate(t.getDate()+e),t},e.prototype.handlePermissionsError=function(){(new b).standardErrorPopup("error","Error","An unknown error has occurred. Please refresh the page and try again!")},e.prototype.initPermissions=function(){var e=this;this.api.openOverlay(),this.api.getFacebookPermissions().subscribe((function(t){console.log(t),t.hasOwnProperty("permissions")?(e.permissions=t.permissions,e.api.closeOverlay(),e.getLoginStatus()):e.handlePermissionsError()}),(function(){e.handlePermissionsError()}))},e.\u0275fac=function(t){return new(t||e)(p.Nb(c.a),p.Nb(r.c),p.Nb(l.a),p.Nb(s.a),p.Nb(a.a),p.Nb(d.a))},e.\u0275cmp=p.Hb({type:e,selectors:[["app-login"]],decls:26,vars:0,consts:[[1,"header","bg-gradient-primary","py-7","py-lg-8"],[1,"container"],[1,"header-body","text-center","mb-7"],[1,"row","justify-content-center"],[1,"col-lg-5","col-md-6"],[1,"text-white"],[1,"text-lead","text-white"],[1,"separator","separator-bottom","separator-skew","zindex-100"],["x","0","y","0","viewBox","0 0 2560 100","preserveAspectRatio","none","version","1.1","xmlns","http://www.w3.org/2000/svg"],["points","2560 0 2560 100 0 100",1,"fill-default"],[1,"container","mt--8","pb-5"],[1,"col-lg-5","col-md-7"],[1,"card","bg-secondary","shadow","border-0"],[1,"card-header","bg-transparent","pb-5"],[1,"text-muted","text-center","mt-2","mb-3"],[1,"btn-wrapper","text-center"],[1,"btn","btn-neutral","btn-icon",3,"click"],[1,"btn-inner--icon"],["src","assets/img/icons/common/facebook.svg"],[1,"btn-inner--text"]],template:function(e,t){1&e&&(p.Sb(0,"div",0),p.Sb(1,"div",1),p.Sb(2,"div",2),p.Sb(3,"div",3),p.Sb(4,"div",4),p.Sb(5,"h1",5),p.Dc(6,"Welcome!"),p.Rb(),p.Sb(7,"p",6),p.Dc(8,"Sign in with Facebook to get started"),p.Rb(),p.Rb(),p.Rb(),p.Rb(),p.Rb(),p.Sb(9,"div",7),p.hc(),p.Sb(10,"svg",8),p.Ob(11,"polygon",9),p.Rb(),p.Rb(),p.Rb(),p.gc(),p.Sb(12,"div",10),p.Sb(13,"div",3),p.Sb(14,"div",11),p.Sb(15,"div",12),p.Sb(16,"div",13),p.Sb(17,"div",14),p.Sb(18,"small"),p.Dc(19,"Sign in with"),p.Rb(),p.Rb(),p.Sb(20,"div",15),p.Sb(21,"a",16),p.ec("click",(function(){return t.login()})),p.Sb(22,"span",17),p.Ob(23,"img",18),p.Rb(),p.Sb(24,"span",19),p.Dc(25,"Facebook"),p.Rb(),p.Rb(),p.Rb(),p.Rb(),p.Rb(),p.Rb(),p.Rb(),p.Rb())},styles:["#particles-js[_ngcontent-%COMP%]{height:100%;width:100%;background-color:#232741;position:absolute}"]}),e}();function f(e,t){if(1&e&&(p.Sb(0,"div",19),p.Ob(1,"input",20),p.Sb(2,"label",21),p.Dc(3),p.Rb(),p.Rb()),2&e){var o=t.$implicit;p.Ab(1),p.mc("id",o.id),p.Ab(1),p.mc("for",o.id),p.Ab(1),p.Ec(o.name)}}var m=o("PSD3"),v=[{path:"login",component:g},{path:"register",component:function(){function e(e,t,o,r,n){this.wizardService=e,this.a=t,this.api=o,this.router=r,this.cookieService=n,this.choices=[],this.selectedAccount="",this.choices=e.radioButtons,console.log(this.choices),this.a.setComponent(this.router),0==this.choices.length&&(m.fire({icon:"question",title:"Can't find any pages",text:"You will need to connect your Instagram account to a Facebook page in order to continue!",footer:"You can find out more&nbsp;<a target='_blank' href='https://help.instagram.com/1094643983940381'><b>Here</b></a>"}),this.router.navigate(["login"]))}return e.prototype.ngOnInit=function(){},e.prototype.updateSelectedAccount=function(){for(var e=0;e<this.choices.length;e++){var t=document.getElementById(this.choices[e].id);1==t.checked&&(this.selectedAccount={name:t.parentElement.children[1].innerText,id:t.id},console.log(t))}},e.prototype.finalize=function(){var e=this;if(this.updateSelectedAccount(),""!=this.selectedAccount)if(""!=this.wizardService.firebaseUid){var t={FirebaseUid:this.wizardService.firebaseUid,SelectedUserName:this.selectedAccount.name,FacebookAccountId:this.selectedAccount.id};this.api.openOverlay(),this.api.finalizeUserRegistration(t).subscribe((function(t){if(e.api.closeOverlay(),!0===t.hasAuth&&!0===t.hasPermissions)null==t.token&&null==t.token&&""==t.token||(e.cookieService.set("TEMPKEY",t.token,e.getExpireDate(24)),e.wizardService.data=[],e.wizardService.radioButtons=[],e.router.navigate([""]));else if(!1===t.hasPermissions)return void m.fire({icon:"question",title:"Can't find Instagram account",text:"You will need to connect your Instagram account to a Facebook page in order to continue!",footer:"You can find out more&nbsp;<a target='_blank' href='https://help.instagram.com/1094643983940381'><b>Here</b></a>"})}),(function(t){e.router.navigate([""]),m.fire({icon:"question",title:"Something went wrong",text:"Sorry for the inconvenience, please try and sign in again :)"})}))}else alert("An error has occured! Please try again!");else alert("An account must be selected before proceeding!")},e.prototype.getExpireDate=function(e){var t=new Date(Date.now());return t.setDate(t.getDate()+e),t},e.\u0275fac=function(t){return new(t||e)(p.Nb(a.a),p.Nb(l.a),p.Nb(s.a),p.Nb(r.c),p.Nb(d.a))},e.\u0275cmp=p.Hb({type:e,selectors:[["app-register"]],decls:23,vars:1,consts:[[1,"header","bg-gradient-primary","py-7","py-lg-8"],[1,"container"],[1,"header-body","text-center","mb-7"],[1,"row","justify-content-center"],[1,"col-lg-5","col-md-6"],[1,"text-white"],[1,"text-lead","text-white"],[1,"separator","separator-bottom","separator-skew","zindex-100"],["x","0","y","0","viewBox","0 0 2560 100","preserveAspectRatio","none","version","1.1","xmlns","http://www.w3.org/2000/svg"],["points","2560 0 2560 100 0 100",1,"fill-default"],[1,"container","mt--8","pb-5"],[1,"col-lg-6","col-md-8"],[1,"card","bg-secondary","shadow","border-0"],[1,"card-body","px-lg-5","py-lg-5"],["role","form","name","radioForm"],[1,"form-group"],["class","custom-control custom-control-alternative custom-radio mb-3",4,"ngFor","ngForOf"],[1,"text-center"],["type","button",1,"btn","btn-primary","mt-4",3,"click"],[1,"custom-control","custom-control-alternative","custom-radio","mb-3"],["name","custom-radio-1","type","radio",1,"custom-control-input",3,"id"],[1,"custom-control-label",3,"for"]],template:function(e,t){1&e&&(p.Sb(0,"div",0),p.Sb(1,"div",1),p.Sb(2,"div",2),p.Sb(3,"div",3),p.Sb(4,"div",4),p.Sb(5,"h1",5),p.Dc(6,"One more step!"),p.Rb(),p.Sb(7,"p",6),p.Dc(8,"Please choose an account to continue"),p.Rb(),p.Rb(),p.Rb(),p.Rb(),p.Rb(),p.Sb(9,"div",7),p.hc(),p.Sb(10,"svg",8),p.Ob(11,"polygon",9),p.Rb(),p.Rb(),p.Rb(),p.gc(),p.Sb(12,"div",10),p.Sb(13,"div",3),p.Sb(14,"div",11),p.Sb(15,"div",12),p.Sb(16,"div",13),p.Sb(17,"form",14),p.Sb(18,"div",15),p.Bc(19,f,4,3,"div",16),p.Rb(),p.Sb(20,"div",17),p.Sb(21,"button",18),p.ec("click",(function(){return t.finalize()})),p.Dc(22,"Create account"),p.Rb(),p.Rb(),p.Rb(),p.Rb(),p.Rb(),p.Rb(),p.Rb(),p.Rb()),2&e&&(p.Ab(19),p.lc("ngForOf",t.choices))},directives:[i.l,i.f,i.g,n.j],styles:[""]}),e}()}];o.d(t,"AuthLayoutModule",(function(){return y}));var y=function(){function e(){}return e.\u0275mod=p.Lb({type:e}),e.\u0275inj=p.Kb({factory:function(t){return new(t||e)},imports:[[n.b,r.f.forChild(v),i.b]]}),e}()}}]);